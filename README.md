# CRSLang

The code in this repository aims to generate a new representation for the OWASP CRS rules.

## Why?

The goal is to abstract OWASP CRS from the specifics of the Seclang language in which it is currently written.

## Features

- Extends the listener generated by the ANTLR Seclang parser.
- Loads Seclang rule information stored in the CRS files, including comments.
- Defines a new representation for the rules and translates them into it.

## Usage

Initialize the repo and its submodule:

```bash
git clone --recurse-submodules https://gitlab.fing.edu.uy/gsi/seclang/crslang.git
```

Generate the ANTLR parser code and build the project:

```bash
go run mage.go build
```

Load and translate the Seclang OWASP CRS files to the new representation:

```bash
./crslang -o crs seclang_parser/testdata/crs
```

Load and translate the CRSLang back to Seclang:

```bash
./crslang -s crs.yaml
```

Run the tests:

```bash
go test -v
```
